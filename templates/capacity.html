{% extends "base.html" %}
{% block content %}

<!-- ================= PI READINESS ================= -->
<div style="background: #161c2d; padding: 30px; border-radius: 14px; border: 1px solid #1e293b; display: flex; justify-content: space-between; align-items: stretch; margin-bottom: 30px; gap: 22px;">

  <!-- LEFT: SCORE -->
  <div style="flex: 1;">
      <h2 style="color: #86BC25; font-size: 14px; text-transform: uppercase; margin: 0;">
        PI Readiness Index
      </h2>

      <!-- Current PI indicator (as text, above %) -->
      <div style="margin-top: 8px; font-size: 12px; color: #94a3b8;">
        Current PI: <span style="color:#cbd5f5; font-weight: 800;">PI-Q4</span>
      </div>

      <div style="font-size: 54px; font-weight: 800; margin: 10px 0 6px 0;">
        {{ score }}%
      </div>

     <p style="color: #94a3b8; margin: 0;">
        Total Available:
        <strong style="color:#cbd5f5;">{{ total_sp }} Story Points</strong>
     </p>


      <!-- Progress bar -->
      <div style="margin-top: 18px; background: rgba(255,255,255,0.08); height: 12px; border-radius: 10px; overflow: hidden;">
          <div style="width: {{ score }}%; height: 100%; background: #86BC25; box-shadow: 0 0 15px rgba(134,188,37,0.7);"></div>
      </div>
  </div>

  <!-- RIGHT: PI HISTORY (Q1-Q3 only) -->
  <div style="width: 44%; min-width: 360px; display:flex; flex-direction:column; justify-content:center;">
      <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom: 10px;">
        <div style="color:#cbd5f5; font-weight:900; font-size:12px; letter-spacing:0.5px; text-transform:uppercase;">
          PI Capacity History
        </div>
        <div style="color:#94a3b8; font-size:12px;">
          (Previous PIs)
        </div>
      </div>

      <div style="display:grid; grid-template-columns:repeat(3, 1fr); gap: 12px;">
        <!-- Q1 -->
        <div style="border:1px solid #1e293b; border-radius:14px; padding:14px; background:#0f172a;">
          <div style="font-size:11px; color:#94a3b8;">PI-Q1</div>
          <div style="margin-top:6px; font-size:18px; font-weight:900; color:#cbd5f5;">260</div>
          <div style="font-size:11px; color:#94a3b8;">Story Points</div>
        </div>

        <!-- Q2 -->
        <div style="border:1px solid #1e293b; border-radius:14px; padding:14px; background:#0f172a;">
          <div style="font-size:11px; color:#94a3b8;">PI-Q2</div>
          <div style="margin-top:6px; font-size:18px; font-weight:900; color:#cbd5f5;">275</div>
          <div style="font-size:11px; color:#94a3b8;">Story Points</div>
        </div>

        <!-- Q3 -->
        <div style="border:1px solid #1e293b; border-radius:14px; padding:14px; background:#0f172a;">
          <div style="font-size:11px; color:#94a3b8;">PI-Q3</div>
          <div style="margin-top:6px; font-size:18px; font-weight:900; color:#cbd5f5;">290</div>
          <div style="font-size:11px; color:#94a3b8;">Story Points</div>
        </div>
      </div>

      <!-- Optional hint line (clean) -->
      <div style="margin-top: 10px; color:#94a3b8; font-size: 12px;">
        Use this to compare PI-over-PI capacity changes before planning.
      </div>
  </div>

</div>

<!-- ================= TEAM CAPACITY TABLE ================= -->
<div style="background: #161c2d; padding: 30px; border-radius: 14px; border: 1px solid #1e293b;">
    <h3 style="margin-top: 0;">Team A | Resource Allocation</h3>

    <table width="100%" style="border-collapse: collapse; margin-top: 20px;">
        <tr style="text-align: left; color: #94a3b8; border-bottom: 1px solid #1e293b; font-size: 12px;">
            <th style="padding: 15px 0;">Name</th>
            <th>ROLE</th>
            <th>LEAVES</th>
            <th>NET CAPACITY</th>
            <th>STORY POINTS PER CAPITA LAST SPRINT</th>
            <th>STORY POINTS PER CAPITA</th>
        </tr>

        {% for m in members %}
        <tr style="border-bottom: 1px solid rgba(255,255,255,0.05);">
            <td style="padding: 15px 0; font-weight: bold;">{{ m.name }}</td>
            <td>{{m.role}}</td>
            <td style="color: #ef4444;">{{ m.leaves }} Days</td>
            <td>{{ m.cap }}</td>
            <td style="color:#38bdf8; font-weight:800;">{{ m.last_sprint_sp }}</td>
            <td style="color: #86BC25;">{{ m.sprint_avg }}</td>
        </tr>
        {% endfor %}
    </table>
</div>

{% endblock %}
